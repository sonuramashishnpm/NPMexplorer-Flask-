<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>NPMBoard</title>
  <link rel="stylesheet" href="{{url_for('static', filename='NPMboardstyle.css')}}">
  <link rel="icon" href="{{url_for('static', filename='NPMboard.jpg')}}">
  <style>
    body {
      margin: 0;
      font-family: 'Inter', sans-serif;
      background: #f0f0f0;
      overflow: hidden;
    }
    #toolbar {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      display: flex;
      gap: 10px;
      padding: 10px;
      background: linear-gradient(to right, #fff, #eee);
      box-shadow: 0 2px 10px rgba(0,0,0,0.2);
      border-bottom-left-radius: 10px;
      border-bottom-right-radius: 10px;
      z-index: 1000;
      transition: all 0.3s ease;
      flex-wrap: wrap;
    }
    .tool-button {
      padding: 8px 12px;
      border: none;
      background: #ffffff;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      cursor: pointer;
      transition: 0.2s;
      font-size: 14px;
    }
    .tool-button:hover {
      background-color: #e0e0e0;
      transform: scale(1.05);
    }
    canvas {
      position: absolute;
      top: 60px;
      left: 0;
      width: 100vw;
      height: calc(100vh - 60px);
      border-radius: 10px;
      background-color: white;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      cursor: crosshair;
    }
    input[type=color], input[type=range] {
      cursor: pointer;
    }
    #tooltip {
      position: absolute;
      background: #333;
      color: white;
      padding: 3px 8px;
      border-radius: 5px;
      font-size: 12px;
      display: none;
      pointer-events: none;
    }
    #noteInput {
      position: absolute;
      top: 80px;
      left: 20px;
      width: 200px;
      height: 100px;
      resize: both;
      background: #fff3cd;
      color: #000;
      padding: 10px;
      border-radius: 10px;
      border: 1px solid #ccc;
      font-size: 14px;
      display: none;
    }
  </style>
</head>
<body>
  <div id="toolbar">
    <input type="color" id="colorPicker" title="Pen Color">
    <input type="range" id="brushSize" min="1" max="50" title="Brush Size">
    <button class="tool-button" id="eraser" title="Eraser">üßΩ</button>
    <button class="tool-button" id="clear" title="Clear Canvas">‚ôªÔ∏è</button>
    <button class="tool-button" id="save" title="Save Drawing">üíæ</button>
    <button class="tool-button" id="fullscreen" title="Toggle Fullscreen">‚õ∂</button>
    <button class="tool-button" id="undo" title="Undo">‚Ü©Ô∏è</button>
    <button class="tool-button" id="redo" title="Redo">‚Ü™Ô∏è</button>
    <button class="tool-button" id="stickyNote" title="Add Sticky Note">üìù</button>
    <button class="tool-button" id="drawRect" title="Draw Rectangle">‚¨õ</button>
    <button class="tool-button" id="drawCircle" title="Draw Circle">‚ö™</button>
    <button class="tool-button" id="IframeNPM" title="NPMexplorer" onclick="shownpm()">NPMexplorer</button>
    <span id="colorDisplay"></span>
  </div>
  <canvas id="canvas">
   
  </canvas>
  <textarea id="noteInput" placeholder="Type your note..."></textarea>
  <div id="tooltip"></div>
  <div>
    <iframe id="npmIframe" src="/index.html" style="display: none; width: 1000px; height: 1000px; border: none;"></iframe>
  </div> 

  <script>
   function  shownpm(){
        document.getElementById('npmIframe').style.display = 'block';
        
    }
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    const colorPicker = document.getElementById('colorPicker');
    const brushSize = document.getElementById('brushSize');
    const eraser = document.getElementById('eraser');
    const clearBtn = document.getElementById('clear');
    const saveBtn = document.getElementById('save');
    const fullscreenBtn = document.getElementById('fullscreen');
    const undoBtn = document.getElementById('undo');
    const redoBtn = document.getElementById('redo');
    const tooltip = document.getElementById('tooltip');
    const colorDisplay = document.getElementById('colorDisplay');
    const stickyNoteBtn = document.getElementById('stickyNote');
    const drawRectBtn = document.getElementById('drawRect');
    const drawCircleBtn = document.getElementById('drawCircle');
    const noteInput = document.getElementById('noteInput');

    let isDrawing = false;
    let x = 0, y = 0;
    let drawingColor = '#000000';
    let drawingSize = 5;
    let isEraser = false;
    let history = [];
    let historyStep = -1;
    let drawingShape = null;

    function resizeCanvas() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight - 60;
    }
    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    canvas.addEventListener('mousedown', e => {
      x = e.offsetX;
      y = e.offsetY;
      isDrawing = true;
      if (drawingShape === 'rectangle') return;
      if (drawingShape === 'circle') return;
      ctx.beginPath();
      ctx.moveTo(x, y);
    });

    canvas.addEventListener('mousemove', e => {
      if (!isDrawing || drawingShape) return;
      draw(e.offsetX, e.offsetY);
    });

    canvas.addEventListener('mouseup', e => {
      isDrawing = false;
      ctx.closePath();
      if (drawingShape === 'rectangle') {
        const w = e.offsetX - x;
        const h = e.offsetY - y;
        ctx.fillStyle = drawingColor;
        ctx.fillRect(x, y, w, h);
      } else if (drawingShape === 'circle') {
        const radius = Math.sqrt(Math.pow(e.offsetX - x, 2) + Math.pow(e.offsetY - y, 2));
        ctx.beginPath();
        ctx.arc(x, y, radius, 0, Math.PI * 2);
        ctx.fillStyle = drawingColor;
        ctx.fill();
      }
      drawingShape = null;
      saveHistory();
    });

    function draw(newX, newY) {
      ctx.strokeStyle = isEraser ? '#ffffff' : drawingColor;
      ctx.lineWidth = drawingSize;
      ctx.lineCap = 'round';
      ctx.lineTo(newX, newY);
      ctx.stroke();
      x = newX;
      y = newY;
    }

    function saveHistory() {
      history = history.slice(0, historyStep + 1);
      history.push(canvas.toDataURL());
      historyStep++;
    }

    function restoreHistory(step) {
      const img = new Image();
      img.src = history[step];
      img.onload = () => {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.drawImage(img, 0, 0);
      };
    }

    colorPicker.addEventListener('input', () => {
      drawingColor = colorPicker.value;
      colorDisplay.textContent = colorPicker.value;
    });

    brushSize.addEventListener('input', () => {
      drawingSize = brushSize.value;
    });

    eraser.addEventListener('click', () => {
      isEraser = !isEraser;
      eraser.textContent = isEraser ? '‚úèÔ∏è' : 'üßΩ';
    });

    clearBtn.addEventListener('click', () => {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      saveHistory();
    });

    saveBtn.addEventListener('click', () => {
      const link = document.createElement('a');
      link.download = 'whiteboard.png';
      link.href = canvas.toDataURL();
      link.click();
    });

    fullscreenBtn.addEventListener('click', () => {
      if (!document.fullscreenElement) {
        document.documentElement.requestFullscreen();
      } else {
        document.exitFullscreen();
      }
    });

    undoBtn.addEventListener('click', () => {
      if (historyStep > 0) {
        historyStep--;
        restoreHistory(historyStep);
      }
    });

    redoBtn.addEventListener('click', () => {
      if (historyStep < history.length - 1) {
        historyStep++;
        restoreHistory(historyStep);
      }
    });

    document.querySelectorAll('.tool-button, input').forEach(el => {
      el.addEventListener('mouseover', (e) => {
        tooltip.textContent = e.target.title;
        tooltip.style.left = e.pageX + 5 + 'px';
        tooltip.style.top = e.pageY + 5 + 'px';
        tooltip.style.display = 'block';
      });
      el.addEventListener('mouseout', () => {
        tooltip.style.display = 'none';
      });
    });

    stickyNoteBtn.addEventListener('click', () => {
      noteInput.style.display = noteInput.style.display === 'none' ? 'block' : 'none';
    });

    drawRectBtn.addEventListener('click', () => {
      drawingShape = 'rectangle';
    });

    drawCircleBtn.addEventListener('click', () => {
      drawingShape = 'circle';
    });

    saveHistory();
  </script>
</body>
</html>
